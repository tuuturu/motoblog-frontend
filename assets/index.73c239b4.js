import{o as i,c as d,a as c,F as f,r as E,p as v,b as y,t as l,L as u,M,d as k,m as x,e as _,f as L,g as $,h as S,i as T,j as b,k as D,l as g,n as A}from"./vendor.f4dc2203.js";const V=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&a(r)}).observe(document,{childList:!0,subtree:!0});function n(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerpolicy&&(s.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?s.credentials="include":o.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(o){if(o.ep)return;o.ep=!0;const s=n(o);fetch(o.href,s)}};V();var p=(e,t)=>{const n=e.__vccOpts||e;for(const[a,o]of t)n[a]=o;return n};const N={name:"NewsView",computed:{posts(){return this.$store.state.posts.posts.sort(P)}},methods:{trimText:O,ensureImage:H},async created(){await this.$store.dispatch("posts/fetch")}};function O(e){let t=e;return t=t.substring(0,t.lastIndexOf(" "))+"..",t}function P(e,t){return e.time<t.time}function H(e){return!e||e.length===0?"https://via.placeholder.com/300x300":e[0]}const R=e=>(v("data-v-47135d58"),e=e(),y(),e),C={class:"NewsView"},U={class:"container"},B=R(()=>c("h1",null,"News",-1)),F={class:"post-list"},j=["onClick"],q=["src"],z={class:"content"},J=["href"];function K(e,t,n,a,o,s){return i(),d("div",C,[c("div",U,[B,c("ul",F,[(i(!0),d(f,null,E(s.posts,r=>(i(),d("li",{class:"post-list-item",key:r.id,onClick:h=>e.$router.push(`/posts/${r.id}`)},[c("img",{alt:"First image from the trip",src:s.ensureImage(r.images)},null,8,q),c("div",z,[c("a",{href:`/posts/${r.id}`},[c("h2",null,l(r.title),1)],8,J),c("p",null,l(s.trimText(r.content)),1)])],8,j))),128))])])])}var G=p(N,[["render",K],["__scopeId","data-v-47135d58"]]),w=(()=>window.env!==void 0?window.env:{BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0})();const Y="https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",W=u.tileLayer(Y,{id:"mapbox/streets-v11",accessToken:w.VITE_APP_MAP_TILES_ACCESS_TOKEN,tileSize:512,zoomOffset:-1}),Q=u.icon({iconUrl:M,shadowUrl:k,iconSize:[25,41],iconAnchor:[12.5,41]}),X={name:"Map",props:{coordinates:{type:Object,required:!0}},data:()=>({map:null}),methods:{addMarker(e){u.marker(e,{icon:Q}).addTo(this.map),this.map.setView(e,15)}},mounted(){this.map=u.map("map"),this.map.addLayer(W),this.addMarker(Z(this.coordinates))}};function Z(e){return[e.latitude,e.longitude]}const ee={id:"map",class:"Map"};function te(e,t,n,a,o,s){return i(),d("div",ee)}var se=p(X,[["render",te],["__scopeId","data-v-0e4ef7e2"]]);function oe(e,t){if(!t||t.length===0)return e;var n=document.createElement("html");n.innerHTML=e;let a=n.getElementsByTagName("p");return t.forEach((o,s)=>{let r=document.createElement("img");r.src=o,r.style.height="248px",r.style.alignSelf=s%2==0?"flex-start":"flex-end",s<a.length&&a[s].insertAdjacentElement("afterend",r)}),n.innerHTML}const ne=["January","February","March","April","May","June","July","August","September","October","November","December"];function re(e){return ne[e]}const ae={name:"PostDetailsView",components:{Map:se},computed:{post(){return this.$store.state.posts.posts.find(t=>t.id===this.postID)},dateStamp(){const e=new Date(this.post.time),t=e.getUTCFullYear(),n=re(e.getMonth());return`${e.getDate()}. ${n} ${t}`},content(){let e=x.parse(this.post.content);return e=oe(e,this.post.images),e},coordinates(){const e=this.post.coordinates;return!e||e.length===0?null:e}},data:()=>({postID:-1}),async created(){const e=this.$route.params.id;await this.$store.dispatch("posts/fetchDetails",e),this.postID=e}},ce={class:"PostDetailsView"},ie={key:0,class:"content"},de={class:"date-stamp"},pe=["innerHTML"];function le(e,t,n,a,o,s){const r=_("Map");return i(),d("div",ce,[e.postID!==-1?(i(),d("div",ie,[c("h1",null,l(s.post.title),1),s.coordinates?(i(),L(r,{key:0,coordinates:s.coordinates},null,8,["coordinates"])):$("",!0),c("span",de,l(s.dateStamp),1),c("div",{class:"post-content",innerHTML:s.content},null,8,pe)])):$("",!0)])}var ue=p(ae,[["render",le],["__scopeId","data-v-2ee3db44"]]);const _e=[{path:"/",redirect:"/news"},{path:"/news",component:G},{path:"/posts/:id",component:ue}],me=S({history:T(),routes:_e}),I=b.create({baseURL:w.VITE_APP_POST_SERVICE_URL}),he=()=>({posts:[]}),fe={post(e,t){const n=e.posts.findIndex(a=>a.id===t.id);n!==-1&&e.posts.splice(n,1),e.posts.push(t)},posts(e,t){e.posts.splice(0,e.posts.length),e.posts.push(...t)}},ve={async fetch({commit:e}){const{data:t}=await I.request({url:"/posts",method:"GET"});e("posts",t)},async fetchDetails({commit:e},t){const{data:n}=await I.request({url:`/posts/${t}`,method:"GET"});e("post",n)}};var ye={namespaced:!0,state:he,mutations:fe,actions:ve},$e=D({modules:{posts:ye}});const ge={name:"Header"},we=e=>(v("data-v-f0dda07e"),e=e(),y(),e),Ie={class:"Header"},Ee=we(()=>c("a",{href:"/"},"Motoblog",-1)),Me=[Ee];function ke(e,t,n,a,o,s){return i(),d("div",Ie,Me)}var xe=p(ge,[["render",ke],["__scopeId","data-v-f0dda07e"]]);const Le={components:{Header:xe}};function Se(e,t,n,a,o,s){const r=_("Header"),h=_("router-view");return i(),d(f,null,[g(r),g(h)],64)}var Te=p(Le,[["render",Se]]);const m=A(Te);m.use(me);m.use($e);m.mount("#app");
